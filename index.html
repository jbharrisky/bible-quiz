<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Google Sheet Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6fa; margin: 0; padding: 20px; }
    .container { background: #fff; padding: 20px; max-width: 700px; margin: auto; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    h1 { margin-top: 0; }
    .question { font-weight: bold; margin-bottom: 12px; }
    .choices label { display: block; margin: 6px 0; padding: 8px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; }
    .navigation { margin-top: 20px; display: flex; justify-content: space-between; }
    button { padding: 10px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .btn-primary { background: #2563eb; color: white; }
    .btn-secondary { background: #e5e7eb; }
    .result, .explanation { margin-top: 20px; padding: 15px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; display: none; }
    img { max-width: 100%; margin-top: 10px; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Google Sheet Quiz</h1>
    <div id="quiz">Loading questions...</div>
    <div class="navigation">
      <button id="prevBtn" class="btn-secondary">Previous</button>
      <button id="nextBtn" class="btn-primary">Next</button>
    </div>
    <div id="result" class="result"></div>
  </div>

  <script>
    const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTGWgTvf3kg9QYY_uwOSUrrXayVQ5dKUJFvnTVN3cEKwLx7LBxdT2GhlEhyMqxwZnaRc78jvaZ3DWzH/pub?output=csv"; // ðŸ”¹ Replace with your sheet link

    let QUESTIONS = [];
    let currentIndex = 0;
    let answers = [];

    const quizEl = document.getElementById("quiz");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const resultEl = document.getElementById("result");

    async function loadQuestions() {
      const res = await fetch(url);
      const text = await res.text();
      const rows = text.trim().split("\n").map(r => r.split(","));

      rows.shift(); // remove headers

     QUESTIONS = rows.map(r => {
  const q = {
    id: r[0],  // keep ID if you need it
    text: r[1], 
    correct: r[2],
    wrongs: [r[3], r[4], r[5]],
    category: r[6],
    explanation: r[7],
    images: [r[8], r[9], r[10]].filter(Boolean)
  };

        // Combine correct + wrong answers and shuffle them
        q.choices = [q.correct, ...q.wrongs].sort(() => Math.random() - 0.5);
  return q;
});

      answers = new Array(QUESTIONS.length).fill(null);
      renderQuestion();
    }

    function renderQuestion() {
      if (QUESTIONS.length === 0) return;
      const q = QUESTIONS[currentIndex];
      quizEl.innerHTML = `
        <div class="question">Q${currentIndex+1}: ${q.text}</div>
        <div class="choices">
          ${q.choices.map(c => `
            <label>
              <input type="radio" name="q${currentIndex}" value="${c}" ${answers[currentIndex] === c ? "checked" : ""}>
              ${c}
            </label>
          `).join("")}
        </div>
      `;
      prevBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === QUESTIONS.length-1 ? "Submit" : "Next";
    }

    quizEl.addEventListener("change", (e) => {
      if(e.target.name === `q${currentIndex}`){
        answers[currentIndex] = e.target.value;
      }
    });

    nextBtn.addEventListener("click", () => {
      if(currentIndex === QUESTIONS.length-1){
        showResult();
      } else {
        currentIndex++;
        renderQuestion();
      }
    });

    prevBtn.addEventListener("click", () => {
      if(currentIndex > 0){
        currentIndex--;
        renderQuestion();
      }
    });

    function showResult() {
      let score = 0;
      let details = "";

      QUESTIONS.forEach((q,i) => {
        const correct = answers[i] === q.correct;
        if (correct) score++;

        details += `
          <div class="explanation">
            <strong>Q${i+1}:</strong> ${q.text}<br>
            <strong>Your Answer:</strong> ${answers[i] || "No answer"}<br>
            <strong>Correct Answer:</strong> ${q.correct}<br>
            <em>Category:</em> ${q.category}<br>
            <p>${q.explanation || ""}</p>
            ${q.images.map(img => `<img src="${img}" alt="image for question">`).join("")}
          </div>
        `;
      });

      quizEl.style.display = "none";
      document.querySelector(".navigation").style.display = "none";
      resultEl.style.display = "block";
      resultEl.innerHTML = `<h2>Your Score: ${score} / ${QUESTIONS.length}</h2>${details}`;
    }

    loadQuestions();
  </script>
</body>
</html>

